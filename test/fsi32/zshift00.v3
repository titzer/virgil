//@execute = 42
def d_infinity  = 0x7ff00000u;
def d_minus_infinity    = 0xfff00000u;

def foo(sign: int, exp: int, mantissa: u32) -> u32 {
	var bits = if(sign != 0, 0x80000000u);
	if (exp < -1076) return bits;
	if (exp <= -1023) {
		// subnormal; make implicit 1 explicit and shift right
		mantissa = 0x80000000u | mantissa >> 1;
		mantissa = mantissa >> u6.view(-1023 - exp);
		exp = -1023;
	} else if (exp >= 1024) {
		// saturate large exponents to infinity
		return if (sign != 0, d_minus_infinity, d_infinity);
	}
	bits |= (u32.view(u11.view(exp + 1023)) << 20);
	bits |= mantissa >> 12;
	return bits;
}
def main() -> int {
	var result = foo(0, -1023, 0);
	if (result != 0x00080000) return -1;
	return 42;
}
