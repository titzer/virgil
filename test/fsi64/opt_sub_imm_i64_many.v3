//@execute 0=0; 1=18; -1=-18; 7=126; 100=1800; 1000000=18000000; 2147483647=-18; -2147483648=0
// Tests many different immediate values for sub on i64.
// Covers 8-bit, 12-bit, and 32-bit immediate ranges for various architectures.
// Input is multiplied by 0x100000001L to create 64-bit values with upper bits set.
// The 18 immediates sum to 0, so result = 18*a (mod 2^32).

def SCALE: long = 0x100000001L;

// 8-bit immediates (x86 short form)
def sub_1(a: long) -> long { return a - 1L; }
def sub_127(a: long) -> long { return a - 127L; }
def sub_255(a: long) -> long { return a - 255L; }

// 12-bit immediates (arm64 range)
def sub_256(a: long) -> long { return a - 256L; }
def sub_1000(a: long) -> long { return a - 1000L; }
def sub_4095(a: long) -> long { return a - 4095L; }

// 16-bit immediates
def sub_32767(a: long) -> long { return a - 32767L; }
def sub_65535(a: long) -> long { return a - 65535L; }

// 32-bit immediates
def sub_100000(a: long) -> long { return a - 100000L; }

// Negative immediates (subtracting negative = adding)
def sub_neg1(a: long) -> long { return a - -1L; }
def sub_neg127(a: long) -> long { return a - -127L; }
def sub_neg255(a: long) -> long { return a - -255L; }
def sub_neg256(a: long) -> long { return a - -256L; }
def sub_neg1000(a: long) -> long { return a - -1000L; }
def sub_neg4095(a: long) -> long { return a - -4095L; }
def sub_neg32767(a: long) -> long { return a - -32767L; }
def sub_neg65535(a: long) -> long { return a - -65535L; }
def sub_neg100000(a: long) -> long { return a - -100000L; }

def main(a: int) -> int {
	var x = long.view(a) * SCALE;
	var sum: long = 0;
	// Sum up results of all subs (18 ops, immediates sum to 0)
	sum += sub_1(x);
	sum += sub_127(x);
	sum += sub_255(x);
	sum += sub_256(x);
	sum += sub_1000(x);
	sum += sub_4095(x);
	sum += sub_32767(x);
	sum += sub_65535(x);
	sum += sub_100000(x);
	sum += sub_neg1(x);
	sum += sub_neg127(x);
	sum += sub_neg255(x);
	sum += sub_neg256(x);
	sum += sub_neg1000(x);
	sum += sub_neg4095(x);
	sum += sub_neg32767(x);
	sum += sub_neg65535(x);
	sum += sub_neg100000(x);
	// Return low 32 bits
	return int.view(sum);
}
