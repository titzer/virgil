//@execute (0, 0, 0, 0)=true; (0, 0, 1, 0)=false; (0, 1, 0, 0)=false; (0, 1, 1, 0)=true
// tests whether a CallFunction kills loads (as it should)
component A {
	var i: int;
	def update(newi: int) {
		i = newi;
	}
}
type B #unboxed {
	case B1(j: int) { def update(i: int) { A.i = i + j; } }
	case B2(k: int) { def update(i: int) { A.i = i + k; } }
	def update(i: int);
}
def main(which: int, arg: int, val: int, extra: int) -> bool {
	// CallVariantVirtual compiles to a CallFunction
	var b = if(which == 0, B.B1(extra), B.B2(extra));
	A.i = arg;
	var i = A.i;
	b.update(val);
	return A.i == i;
}
